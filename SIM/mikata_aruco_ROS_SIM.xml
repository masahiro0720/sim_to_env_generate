<?xml version="1.0" encoding="utf-8"?>
<Module type="SIM" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
               xsi:noNamespaceSchemaLocation="ISO_22166_202_ModuleProfile.xsd">
  <GenInfo>
    <ModuleName>MikataArm_ROS_open_manipulator</ModuleName>
    <Description>既存のMikataArmパッケージで見つかったMoveIt!との統合問題を解決したROS対応OpenManipulatorであり、実機環境とシミュレーション環境の両方でシームレスな操作を可能にするオープンロボットプラットフォームです。そして、Arucoマーカー検出モジュールからのIDにより動作する機能を追加したモジュール。</Description>
    <Manufacturer>
      <Name>ROBOTIS</Name>
      <Authors>Darby Lim, Hye-Jong KIM, Ryan Shim, Yong-Ho Na</Authors>
      <Maintainers>Pyo, Hye-Jong KIM</Maintainers>
      <CopyrightOwner>Ryusei Tomikawa</CopyrightOwner>
    </Manufacturer>
    <Examples>
      <Item>Simulation: roslaunch open_manipulator_controller open_manipulator_controller.launch use_gazebo:=true use_moveit:=true</Item>
      <Item>Real Robot: roslaunch open_manipulator_controller open_manipulator_controller.launch use_moveit:=true</Item>
      <Item>Sample Script: rosrun open_manipulator_moveit open_manipulator.py (performs simple Pick and Place)</Item>
      <Item>ARMakerID Subscribe: rosrun arm_command_translator command_translator_node.py</Item>
    </Examples>
  </GenInfo>

  <idnType type="Com">
  <moduleID>
    <mID>00000000000000000000000000000000A0F0F0020001000000000000000000</mID>
    <iID>00</iID>
  </moduleID>
  <informationModelVersion>1.0</informationModelVersion>
  <swAspects>
    <moduleID>
      <mID>... (open_manipulator_controllerのID) ...</mID>
      <iID>00</iID>
    </moduleID>
    <moduleID>
      <mID>... (open_manipulator_libsのID) ...</mID>
      <iID>00</iID>
    </moduleID>
    <moduleID>
      <mID>... (open_manipulator_descriptionのID) ...</mID>
      <iID>00</iID>
    </moduleID>
  </swAspects>
  </idnType>

  <Properties>
    <osType type="Ubuntu" bit="64" version="20.04" />
    <compiler>
        <osName>Ubuntu</osName>
        <verRangeOS min="16.04" max="20.04" />
        <compilerName>GCC</compilerName>
        <verRangeCompiler min="9.0" max="Higher" />
        <bitnCPUarch>64, X86</bitnCPUarch>
    </compiler>
    <exeType>
        <Item>
        <opType>PERIODIC</opType>
        <priority>31</priority>
        <hardRT>true</hardRT>
        <timeConstraint>10000</timeConstraint>
        <instanceType>Singleton</instanceType>
        </Item>
    </exeType>
    <Libraries>
        <!-- 論理的な依存関係(RTCが依存する主要コンポーネント)-->
        <Item name="actionlib" />
        <Item name="moveit_core" />
        <Item name="moveit_ros_planning" />
        <Item name="moveit_ros_planning_interface" />
        <Item name="robotis_manipulator" />
        <Item name="dynamixel_workbench_toolbox" />
        <Item name="cmake_modules" />
        <Item name="boost" />
        <Item name="eigen" />
        <Item name="qtbase5-dev" />
        <Item name="qt5-qmake" />
        <Item name="libqt5-core" />
        <Item name="libqt5-gui" />
        <Item name="urdf" />
        <Item name="xacro" />
        <!-- APTパッケージ(Dockerfileでインストールする具体的なパッケージ)-->
        
    </Libraries>
    <organization>
        <owner>
            <mID>...</mID>
            <iID>...</iID>
        </owner>
        <dependency>OWNER</dependency>
        <member>
            <member>
            <mID>... (open_manipulator_controllerのID) ...</mID>
            <iID>00</iID>
            </member>
            <dependency>OWNED</dependency>
        </member>
        <member>
            <member>
            <mID>... (open_manipulator_libsのID) ...</mID>
            <iID>00</iID>
            </member>
            <dependency>OWNED</dependency>
        </member>
    </organization>
  </Properties>

  <IOVariables>
    <Inputs>
        <Input name="option" type="class" complexName="std_msgs/String" description="オプションの指示（例：設定表示コマンド）" />
    </Inputs>

    <Outputs>
        <Output name="kinematics_pose" type="class" complexName="open_manipulator_msgs/KinematicsPose" description="エンドエフェクタの現在の運動学的姿勢" />
        <Output name="states" type="class" complexName="open_manipulator_msgs/OpenManipulatorState" description="ロボット全体の状態（動作中か、アクチュエータが有効かなど）" />
        <Output name="joint_states" type="class" complexName="sensor_msgs/JointState" description="各関節の現在の状態（位置、速度、トルク）" />
    </Outputs>
  
    <InOuts>
        <InOut name="SetJointPosition.srv" type="class" complexName="open_manipulator_msgs/SetJointPosition">
            <Input name="planning_group" type="string" description="プランニンググループ名" />
            <Input name="joint_position" type="class" complexName="open_manipulator_msgs/JointPosition" description="関節空間での目標位置" />
            <Input name="path_time" type="float64" unit="sec" description="経路時間" />
            <Output name="is_planned" type="bool" description="計画の成否" />
        </InOut>
    
        <InOut name="SetKinematicsPose.srv" type="class" complexName="open_manipulator_msgs/SetKinematicsPose">
            <Input name="planning_group" type="string" description="プランニンググループ名" />
            <Input name="end_effector_name" type="string" description="エンドエフェクタ名" />
            <Input name="kinematics_pose" type="class" complexName="open_manipulator_msgs/KinematicsPose" description="タスク空間での目標姿勢" />
            <Input name="path_time" type="float64" unit="sec" description="経路時間" />
            <Output name="is_planned" type="bool" description="計画の成否" />
        </InOut>
    
        <InOut name="SetActuatorState.srv" type="class" complexName="open_manipulator_msgs/SetActuatorState">
            <Input name="set_actuator_state" type="bool" description="アクチュエータの有効/無効状態" />
            <Output name="is_planned" type="bool" description="計画の成否" />
        </InOut>

        <InOut name="SetDrawingTrajectory.srv" type="class" complexName="open_manipulator_msgs/SetDrawingTrajectory">
            <Input name="end_effector_name" type="string" description="エンドエフェクタ名" />
            <Input name="drawing_trajectory_name" type="string" description="描画軌道名" />
            <Input name="param" type="array" complexName="float64" description="軌道パラメータ" />
            <Input name="path_time" type="float64" unit="sec" description="経路時間" />
            <Output name="is_planned" type="bool" description="計画の成否" />
        </InOut>

        <InOut name="GetKinematicsPose.srv" type="class" complexName="open_manipulator_msgs/GetKinematicsPose">
            <Input name="planning_group" type="string" description="プランニンググループ名" />
            <Input name="end_effector_name" type="string" description="エンドエフェクタ名" />
            <Output name="header" type="class" complexName="std_msgs/Header" description="ヘッダー情報" />
            <Output name="kinematics_pose" type="class" complexName="open_manipulator_msgs/KinematicsPose" description="運動学的姿勢" />
        </InOut>

        <InOut name="GetJointPosition.srv" type="class" complexName="open_manipulator_msgs/GetJointPosition">
            <Input name="planning_group" type="string" description="プランニンググループ名" />
            <Output name="joint_position" type="class" complexName="open_manipulator_msgs/JointPosition" description="関節位置" />
        </InOut>
    </InOuts>
  </IOVariables>

  <Status>
    <executionStatus>IDLE</executionStatus>
    <errorType>0</errorType>
  </Status>

  <Services>
    <ServiceXML>
        <ID>SetJointPosition</ID>
        <pvType>Virtual</pvType>
        <moType>MANDATORY</moType>
        <methodList>
            <Method>
                <methodName>goalJointSpacePath</methodName>
                <argType type="string" valueName="planning_group" inout="IN" />
                <argType type="class" valueName="joint_position" inout="IN" complexName="open_manipulator_msgs/JointPosition" />
                <argType type="float64" valueName="path_time" inout="IN" unit="sec" />
                <retType>bool</retType>
                <moType>MANDATORY</moType>
                <reqProvType>PROVIDED</reqProvType>
                <moduleID>
                    <mID>... (open_manipulator_controllerのID) ...</mID>
                    <iID>00</iID>
                </moduleID>
            </Method>
        </methodList>
    </ServiceXML>

    <ServiceXML>
        <ID>SetKinematicsPose</ID>
        <pvType>Virtual</pvType>
        <moType>MANDATORY</moType>
        <methodList>
            <Method>
                <methodName>goalTaskSpacePath</methodName>
                <argType type="string" valueName="planning_group" inout="IN" />
                <argType type="string" valueName="end_effector_name" inout="IN" />
                <argType type="class" valueName="kinematics_pose" inout="IN" complexName="open_manipulator_msgs/KinematicsPose" />
                <argType type="float64" valueName="path_time" inout="IN" unit="sec" />
                <retType>bool</retType>
                <moType>MANDATORY</moType>
                <reqProvType>PROVIDED</reqProvType>
                <moduleID>
                    <mID>... (open_manipulator_controllerのID) ...</mID>
                    <iID>00</iID>
                </moduleID>
            </Method>
        </methodList>
    </ServiceXML>

    <ServiceXML>
        <ID>SetActuatorState</ID>
        <pvType>Virtual</pvType>
        <moType>MANDATORY</moType>
        <methodList>
            <Method>
                <methodName>setActuatorState</methodName>
                <argType type="bool" valueName="set_actuator_state" inout="IN" />
                <retType>bool</retType>
                <moType>MANDATORY</moType>
                <reqProvType>PROVIDED</reqProvType>
                <moduleID>
                    <mID>... (open_manipulator_controllerのID) ...</mID>
                    <iID>00</iID>
                </moduleID>
            </Method>
        </methodList>
    </ServiceXML>

    <ServiceXML>
        <ID>SetDrawingTrajectory</ID>
        <pvType>Virtual</pvType>
        <moType>MANDATORY</moType>
        <methodList>
            <Method>
                <methodName>goalDrawingTrajectory</methodName>
                <argType type="string" valueName="end_effector_name" inout="IN" />
                <argType type="string" valueName="drawing_trajectory_name" inout="IN" />
                <argType type="array" valueName="param" inout="IN" complexName="float64" />
                <argType type="float64" valueName="path_time" inout="IN" unit="sec" />
                <retType>bool</retType>
                <moType>MANDATORY</moType>
                <reqProvType>PROVIDED</reqProvType>
                <moduleID>
                    <mID>... (open_manipulator_controllerのID) ...</mID>
                    <iID>00</iID>
                </moduleID>
            </Method>
        </methodList>
    </ServiceXML>

    <ServiceXML>
        <ID>GetKinematicsPose</ID>
        <pvType>Virtual</pvType>
        <moType>MANDATORY</moType>
        <methodList>
            <Method>
                <methodName>GetKinematicsPose</methodName>
                <argType type="string" valueName="planning_group" inout="IN" />
                <argType type="string" valueName="end_effector_name" inout="IN" />
                <retType type="class" complexName="open_manipulator_msgs/KinematicsPose">
                <retType type="class" complexName="std_msgs/Header" valueName="header" />
                <retType type="class" complexName="open_manipulator_msgs/KinematicsPose" valueName="kinematics_pose" />
                </retType>
                <moType>MANDATORY</moType>
                <reqProvType>PROVIDED</reqProvType>
                <moduleID>
                    <mID>... (open_manipulator_controllerのID) ...</mID>
                    <iID>00</iID>
                </moduleID>
            </Method>
        </methodList>
    </ServiceXML>

    <ServiceXML>
        <ID>GetJointPosition</ID>
        <pvType>Virtual</pvType>
        <moType>MANDATORY</moType>
        <methodList>
            <Method>
                <methodName>GetJointPosition</methodName>
                <argType type="string" valueName="planning_group" inout="IN" />
                <retType type="class" complexName="open_manipulator_msgs/JointPosition">
                <retType type="class" complexName="open_manipulator_msgs/JointPosition" valueName="joint_position" />
                </retType>
                <moType>MANDATORY</moType>
                <reqProvType>PROVIDED</reqProvType>
                <moduleID>
                    <mID>... (open_manipulator_controllerのID) ...</mID>
                    <iID>00</iID>
                </moduleID>
            </Method>
        </methodList>
    </ServiceXML>
  </Services>

  <Infrastructure>
    <middleware>
        <InfraType>
            <name>ROS 1</name>
            <version min="kinetic" max="noetic" />
        </InfraType>
    </middleware>
    <comms>
        <Communication>
            <mostTopProtocol>
                <InfraType>
                    <name>Private Protocol</name>
                    <version min="1.0" max="1.0" />
                </InfraType>
            </mostTopProtocol>
            <underlyingProtocol>
                <DataBus>
                    <connectionType>USB-A</connectionType>
                    <typePhyMac>USB</typePhyMac>
                    <typeNetTrans>TCP/IP</typeNetTrans>
                    <speed value="1000" unit="kbps" />
                </DataBus>
            </underlyingProtocol>
        </Communication>
    </comms>
  </Infrastructure>

  <SafeSecure>
    <Safety>
        <overall mode="BOTH">d</overall>
        <overall mode="BOTH">3</overall>
        <inSafetyLevel>
            <safetyFunctionType>SRSC</safetyFunctionType>
            <validSafetyLevelType>PL</validSafetyLevelType>
            <eachSafetyLevelPL>d</eachSafetyLevelPL>
        </inSafetyLevel>
        <inSafetyLevel>
            <safetyFunctionType>LIMWS</safetyFunctionType>
            <validSafetyLevelType>PL</validSafetyLevelType>
            <eachSafetyLevelPL>d</eachSafetyLevelPL>
        </inSafetyLevel>
    </Safety>
    <Security>
        <CyberSecurity>
            <OverallCybSecurityLevel>2</OverallCybSecurityLevel>
            <inCybSecurityLevel type="INPUT_VALD" value="3" />
            <inCybSecurityLevel type="ACNT_MGT" value="2" />
        </CyberSecurity>
    </Security>
    <additionalInfo>
        <nv>
            <name>required_udev_rule</name>
            <value>KERNEL=="ttyUSB*", DRIVERS=="ftdi_sio", MODE="0666", ATTR{device/latency_timer}="1"</value>
        </nv>
    </additionalInfo>
  </SafeSecure>

  <Modelling>
    <simulationModel>
        <simulator>Gazebo</simulator>
        <mdf type="URDF">
            <Item>open_manipulator_description/urdf/open_manipulator.urdf.xacro</Item>
            <Item>open_manipulator_description/urdf/open_manipulator.gazebo.xacro</Item>
            <Item>open_manipulator_description/urdf/materials.xacro</Item>
        </mdf>
        <mdf type="STL">
            <Item>open_manipulator_description/meshes/chain_link1.stl</Item>
            <Item>open_manipulator_description/meshes/chain_link2.stl</Item>
            <Item>open_manipulator_description/meshes/chain_link3.stl</Item>
            <Item>open_manipulator_description/meshes/chain_link4.stl</Item>
            <Item>open_manipulator_description/meshes/chain_link5.stl</Item>
            <Item>open_manipulator_description/meshes/chain_link6.stl</Item>
            <Item>open_manipulator_description/meshes/chain_link7.stl</Item>
            <Item>open_manipulator_description/meshes/chain_link_grip_l.stl</Item>
            <Item>open_manipulator_description/meshes/chain_link_grip_r.stl</Item>
        </mdf>
        <dynamicSW>
            <exeFileURL>devel/lib/open_manipulator_controller/open_manipulator_controller</exeFileURL>
            <shellCmd>roslaunch open_manipulator_controller open_manipulator_controller.launch use_gazebo:=true use_moveit:=true</shellCmd>
            <properties>
                <Property name="controlPeriod" type="float64" immutable="false" unit="sec" value="0.001" />
            </properties>
        </dynamicSW>
    </simulationModel>
  </Modelling>

  <ExecutableForm>
    <exeForm>
        <exeFileURL>devel/lib/open_manipulator_controller/open_manipulator_controller</exeFileURL>
        <shellCmd>roslaunch open_manipulator_controller open_manipulator_controller.launch use_gazebo:=true use_moveit:=true</shellCmd>
    </exeForm>
    <exeForm>
        <exeFileURL>devel/lib/open_manipulator_controller/open_manipulator_controller</exeFileURL>
        <shellCmd>roslaunch open_manipulator_controller open_manipulator_controller.launch use_moveit:=true</shellCmd>
        <additionalInfo>
            <nv>
                <name>pre_execution_command</name>
                <value>sudo chmod 666 /dev/ttyUSB0</value>
            </nv>
        </additionalInfo>
    </exeForm>


    <exeForm>
      <exeFileURL>~/Dockerfile</exeFileURL>
      <additionalInfo>
        <nv>
          <Name>Libraries</Name>
          <Value>git</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>build-essential</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>cmake</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>python3-catkin-tools</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>python3-rosdep</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>python3-rosinstall</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>python3-rosinstall-generator</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>python3-wstool</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>ros-${ROS_DISTRO}-catkin</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>ros-${ROS_DISTRO}-moveit</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>ros-${ROS_DISTRO}-joint-state-publisher-gui</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>ros-${ROS_DISTRO}-rviz</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>ros-${ROS_DISTRO}-robot-state-publisher</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>ros-${ROS_DISTRO}-xacro</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>ros-${ROS_DISTRO}-gazebo-ros-pkgs</Value>
        </nv>
        <nv>
          <Name>Libraries</Name>
          <Value>ros-${ROS_DISTRO}-gazebo-ros-control</Value>
        </nv>
        <nv>
          <Name>gitURL-name.1</Name>
          <Value>https://github.com/ROBOTIS-GIT/dynamixel-workbench.git</Value>
        </nv>
        <nv>
          <Name>gitURL-branch.1</Name>
          <Value>required</Value>
        </nv>
        <nv>
          <Name>gitURL-name.2</Name>
          <Value>https://github.com/ROBOTIS-GIT/DynamixelSDK.git</Value>
        </nv>
        <nv>
          <Name>gitURL-branch.2</Name>
          <Value>required</Value>
        </nv>
        <nv>
          <Name>gitURL-name.3</Name>
          <Value>https://github.com/ROBOTIS-GIT/dynamixel-workbench-msgs.git</Value>
        </nv>
        <nv>
          <Name>gitURL-branch.3</Name>
          <Value>required</Value>
        </nv>
        <nv>
          <Name>gitURL-name.4</Name>
          <Value>https://github.com/rsdlab/MikataArm.git</Value>
        </nv>
        <nv>
          <Name>gitURL-branch.4</Name>
          <Value>main</Value>
        </nv>
        <nv>
          <Name>gitURL-name.5</Name>
          <Value>https://github.com/ROBOTIS-GIT/robotis_manipulator.git</Value>
        </nv>
        <nv>
          <Name>gitURL-branch.5</Name>
          <Value>main</Value>
        </nv>
        <nv>
          <Name>gitURL-name.6</Name>
          <Value>https://github.com/masahiro0720/arm_command_translator.git</Value>
        </nv>
        <nv>
          <Name>gitURL-branch.6</Name>
          <Value>main</Value>
        </nv>
      </additionalInfo>
    </exeForm>

  </ExecutableForm>
</Module>


